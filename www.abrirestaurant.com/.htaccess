# Redirection pour les ressources partagées
RewriteEngine On

# Ressources communes
RewriteRule ^(templates|media|modules|plugins|components|images|assets)/(.*)$ /$1/$2 [L]

# Détection de la langue du navigateur et redirection
RewriteCond %{REQUEST_URI} ^/$
RewriteCond %{HTTP:Accept-Language} ^en [NC]
RewriteRule ^$ /en/index.html [R=302,L]

RewriteCond %{REQUEST_URI} ^/$
RewriteRule ^$ /fr/index.html [R=302,L]

# Empêcher la redirection pour les dossiers de langue
RewriteCond %{REQUEST_URI} !^/(fr|en)/
RewriteCond %{REQUEST_URI} !^/(templates|media|modules|plugins|components|images|assets)/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{HTTP:Accept-Language} ^en [NC]
RewriteRule ^(.*)$ /en/$1 [L]

RewriteCond %{REQUEST_URI} !^/(fr|en)/
RewriteCond %{REQUEST_URI} !^/(templates|media|modules|plugins|components|images|assets)/
RewriteCond %{REQUEST_FILENAME} !-f
RewriteRule ^(.*)$ /fr/$1 [L]

# Conservation du slash final pour les dossiers
DirectorySlash On